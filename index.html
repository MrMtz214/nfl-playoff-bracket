<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 NFL Playoff Bracket & Pool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        .selected { background-color: #1d4ed8 !important; border-color: #60a5fa !important; color: white !important; transform: scale(1.02); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4); }
        .matchup-card { transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); }
        .glass { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px); }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen pb-24 font-sans selection:bg-blue-500/30">

    <div class="max-w-6xl mx-auto px-4">
        <header class="text-center py-16">
            <h1 class="text-5xl md:text-7xl font-black italic tracking-tighter text-transparent bg-clip-text bg-gradient-to-br from-blue-400 via-emerald-400 to-yellow-400 mb-4">
                ROAD TO SUPER BOWL LX
            </h1>
            <div class="flex flex-wrap justify-center gap-4 text-[10px] font-black uppercase tracking-widest text-slate-500">
                <span>WC: 5pts</span><span>•</span><span>DIV: 10pts</span><span>•</span><span>CONF: 15pts</span><span>•</span><span>SB: 20pts</span>
            </div>
        </header>

        <div id="auth-section" class="max-w-md mx-auto bg-slate-900 p-8 rounded-3xl border border-slate-800 shadow-2xl mb-12">
            <h2 class="text-center text-xl font-bold mb-6 text-slate-300 italic">Join the Pool</h2>
            <div class="space-y-4">
                <input type="text" id="userName" placeholder="Full Name" class="w-full p-4 rounded-xl bg-black border border-slate-700 outline-none focus:border-blue-500 transition-all text-white">
                <input type="email" id="userEmail" placeholder="Email Address" class="w-full p-4 rounded-xl bg-black border border-slate-700 outline-none focus:border-blue-500 transition-all text-white">
                <button onclick="startBracket()" class="w-full bg-blue-600 hover:bg-blue-500 p-4 rounded-xl font-black uppercase tracking-widest transition-all active:scale-95 shadow-lg shadow-blue-900/20">Create My Bracket</button>
            </div>
        </div>

        <div id="main-content" class="hidden space-y-16">
            <div id="bracket-render" class="grid grid-cols-1 gap-12"></div>
            
            <div id="submit-area" class="text-center pt-16 border-t border-slate-900">
                <button onclick="submitFinalPicks()" class="bg-emerald-600 hover:bg-emerald-500 px-20 py-6 rounded-full font-black text-2xl shadow-2xl transform hover:scale-105 transition-all active:scale-95 text-white italic">
                    LOCK IN MY ENTRY
                </button>
            </div>
        </div>

        <div id="leaderboard-section" class="mt-24 max-w-4xl mx-auto">
            <h2 class="text-3xl font-black italic text-center mb-8 text-slate-500 uppercase tracking-tighter">Leaderboard</h2>
            <div class="bg-slate-900 rounded-3xl border border-slate-800 overflow-hidden shadow-2xl">
                <table class="w-full text-left">
                    <thead class="bg-black text-slate-500 text-[10px] uppercase font-black tracking-widest">
                        <tr>
                            <th class="p-6">Predictor</th>
                            <th class="p-6 text-center">Score</th>
                            <th class="p-6">SB Winner</th>
                            <th class="p-6 text-center">Tiebreaker</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body" class="divide-y divide-slate-800 italic">
                        <tr><td colspan="4" class="p-10 text-center text-slate-600">Loading standings...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="bracket-modal" class="hidden fixed inset-0 glass z-50 flex items-center justify-center p-4" onclick="closeModal()">
        <div class="bg-slate-900 w-full max-w-xl rounded-3xl border border-slate-700 p-8 shadow-2xl" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 id="modal-user-name" class="text-2xl font-black italic text-blue-400"></h2>
                    <p class="text-xs text-slate-500 font-bold uppercase tracking-widest">Bracket Summary</p>
                </div>
                <button onclick="closeModal()" class="text-slate-500 hover:text-white text-4xl leading-none">&times;</button>
            </div>
            <div id="modal-content" class="space-y-4"></div>
        </div>
    </div>

<script>
// --- CONFIGURATION ---
const SUPABASE_URL = 'https://qqqsdhtwlbhnlkuzjiwu.supabase.co'; 
const SUPABASE_KEY = 'sb_publishable_EV3pltkn-OfizajBL7ApeQ_QDOBkNPl'; // Replace with your real key
const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// --- SCORING RESULTS (Update these as real games end!) ---
const realResults = {
    afc: { wc: { "2v7": null, "3v6": null, "4v5": null }, div: { d0: null, d1: null }, conf: null },
    nfc: { wc: { "2v7": null, "3v6": null, "4v5": null }, div: { d0: null, d1: null }, conf: null },
    sb_winner: null
};

// --- DATA & STATE ---
const teamData = {
    afc: { 1: { name: "Broncos", id: "den" }, 2: { name: "Patriots", id: "ne" }, 3: { name: "Jaguars", id: "jax" }, 4: { name: "Steelers", id: "pit" }, 5: { name: "Texans", id: "hou" }, 6: { name: "Bills", id: "buf" }, 7: { name: "Chargers", id: "lac" } },
    nfc: { 1: { name: "Seahawks", id: "sea" }, 2: { name: "Bears", id: "chi" }, 3: { name: "Eagles", id: "phi" }, 4: { name: "Panthers", id: "car" }, 5: { name: "Rams", id: "lar" }, 6: { name: "49ers", id: "sf" }, 7: { name: "Packers", id: "gb" } }
};

let picks = { afc: { wc: {}, div: {}, conf: null }, nfc: { wc: {}, div: {}, conf: null }, sb_winner: null, sb_score: { afc: 0, nfc: 0 } };

const getLogo = (id) => `https://a.espncdn.com/i/teamlogos/nfl/500/${id}.png`;

// --- CORE FUNCTIONS ---
function startBracket() {
    if(!document.getElementById('userName').value || !document.getElementById('userEmail').value) return alert("Please enter your name and email.");
    document.getElementById('auth-section').classList.add('hidden');
    document.getElementById('main-content').classList.remove('hidden');
    render();
}

function calculatePoints(userPicks) {
    let pts = 0;
    ['afc', 'nfc'].forEach(conf => {
        Object.keys(realResults[conf].wc).forEach(k => { if(realResults[conf].wc[k] && userPicks[conf].wc[k] === realResults[conf].wc[k]) pts += 5; });
        Object.keys(realResults[conf].div).forEach(k => { if(realResults[conf].div[k] && userPicks[conf].div[k] === realResults[conf].div[k]) pts += 10; });
        if(realResults[conf].conf && userPicks[conf].conf === realResults[conf].conf) pts += 15;
    });
    if(realResults.sb_winner && userPicks.sb_winner === realResults.sb_winner) pts += 20;
    return pts;
}

function render() {
    const container = document.getElementById('bracket-render');
    container.innerHTML = '';
    const grid = document.createElement('div');
    grid.className = "grid grid-cols-1 lg:grid-cols-2 gap-10";

    ['afc', 'nfc'].forEach(conf => {
        const col = document.createElement('div');
        col.className = "space-y-8";
        col.innerHTML = `<h2 class="text-4xl font-black italic uppercase text-slate-800 tracking-tighter mb-4">${conf}</h2>`;

        // 1. Wild Card
        const wcSec = createSectionUI("Wild Card");
        [[2,7], [3,6], [4,5]].forEach(([h, a]) => wcSec.appendChild(createMatchupUI(conf, 'wc', `${h}v${a}`, h, a)));
        col.appendChild(wcSec);

        // 2. Divisional (Reseeding)
        const wcW = Object.values(picks[conf].wc);
        if(wcW.length === 3) {
            const divSec = createSectionUI("Divisional");
            const sorted = [1, ...wcW].sort((a,b) => a-b);
            const matches = [{h: sorted[0], a: sorted[3]}, {h: sorted[1], a: sorted[2]}];
            matches.forEach((m, i) => divSec.appendChild(createMatchupUI(conf, 'div', `d${i}`, m.h, m.a)));
            col.appendChild(divSec);
        }

        // 3. Conference Championship
        const divW = Object.values(picks[conf].div);
        if(divW.length === 2) {
            const ccSec = createSectionUI("Championship");
            ccSec.appendChild(createMatchupUI(conf, 'conf', 'champ', divW[0], divW[1]));
            col.appendChild(ccSec);
        }
        grid.appendChild(col);
    });
    container.appendChild(grid);
    if(picks.afc.conf && picks.nfc.conf) renderSuperBowl(container);
}

function createSectionUI(t) {
    const d = document.createElement('div');
    d.innerHTML = `<p class="text-[10px] font-black uppercase tracking-[0.3em] text-slate-600 mb-4">${t}</p>`;
    return d;
}

function createMatchupUI(conf, round, mId, hS, aS) {
    const card = document.createElement('div');
    card.className = "bg-slate-900 border border-slate-800 rounded-2xl overflow-hidden mb-4 shadow-xl";
    [hS, aS].forEach(seed => {
        const team = teamData[conf][seed];
        const isSelected = (round === 'conf') ? picks[conf].conf === seed : picks[conf][round][mId] === seed;
        const btn = document.createElement('button');
        btn.className = `w-full p-5 flex items-center gap-4 hover:bg-slate-800 transition-all ${isSelected ? 'selected' : ''}`;
        btn.innerHTML = `<span class="text-xs font-black text-slate-600 w-4">${seed}</span><img src="${getLogo(team.id)}" class="w-10 h-10 object-contain"><span class="font-black italic uppercase text-sm">${team.name}</span>`;
        btn.onclick = () => {
            if(round === 'conf') picks[conf].conf = seed;
            else {
                picks[conf][round][mId] = seed;
                if(round === 'wc') { picks[conf].div = {}; picks[conf].conf = null; }
                if(round === 'div') { picks[conf].conf = null; }
            }
            picks.sb_winner = null;
            render();
        };
        card.appendChild(btn);
    });
    return card;
}

function renderSuperBowl(c) {
    const sbDiv = document.createElement('div');
    sbDiv.className = "mt-20 p-12 bg-gradient-to-br from-slate-900 to-black rounded-[3rem] border-2 border-yellow-500/20 shadow-2xl max-w-3xl mx-auto";
    sbDiv.innerHTML = `<h2 class="text-5xl font-black italic text-center mb-12 tracking-tighter bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500 text-transparent">SUPER BOWL LX</h2>`;
    const flex = document.createElement('div');
    flex.className = "flex flex-col md:flex-row justify-center items-center gap-12 mb-12";
    [{c: 'afc', s: picks.afc.conf}, {c: 'nfc', s: picks.nfc.conf}].forEach(t => {
        const team = teamData[t.c][t.s];
        const winner = picks.sb_winner === t.s;
        const div = document.createElement('div');
        div.className = `cursor-pointer p-8 rounded-3xl transition-all border-2 ${winner ? 'bg-blue-600 border-blue-400 scale-110 shadow-2xl' : 'bg-slate-800 border-transparent hover:border-slate-600'}`;
        div.innerHTML = `<img src="${getLogo(team.id)}" class="w-32 h-32 mx-auto mb-4"><p class="font-black
